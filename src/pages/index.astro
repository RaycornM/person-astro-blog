---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import IntroCard from '../components/IntroCard.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

// Use import.meta.glob for blog posts
type Post = {
  url: string;
  frontmatter: {
    title: string;
    pubDate: string;
    description: string;
    heroImage?: string;
  };
};

const postImports = import.meta.glob<Post>('../content/blog/*.md', { eager: true });
const allPosts = Object.values(postImports) as Post[];
const sortedPosts = allPosts
  .sort((a, b) => new Date(b.frontmatter.pubDate).getTime() - new Date(a.frontmatter.pubDate).getTime());
const [latestPost, ...otherPosts] = sortedPosts.slice(0, 3);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<p style="text-align: center;">
    			üçµÊ¨¢ËøéÊù•Âà∞Êó•ÊöÆËå∂‰ºö...
    			<br />
    			Ë¶ÅÂÖàÊù•‰∏ÄÊùØÁ∫¢Ëå∂ÂêóÔºü
			</p>
			 <IntroCard title="„Éû„Çπ„Ç´„É¨„Éº„Éâ" description="‚Ä¶„Çà„ÅÜ„Åì„Åù„ÄÇÊñ∞Êó•ÊöÆÈáå„ÅÆ‰∏ñÁïå„Å∏" />

            <section>
                <h2 class="latest-post">ÊúÄÊñ∞ÊñáÁ´†</h2>
                {latestPost && (
                    <a href={latestPost.url} class="post-card featured">
                        <img 
                            src={latestPost.frontmatter.heroImage || '/assets/blog-placeholder-about.jpg'} 
                            alt={latestPost.frontmatter.title} 
                            style="width: 100%; height: 220px; object-fit: cover; display: block; border-top-left-radius: 1rem; border-top-right-radius: 1rem;"
                            class="post-image"
                        />
                        <div style="padding: 2rem;">
                            <h3 style="margin-top: 0;font-family: 'SmileySans-Oblique';">{latestPost.frontmatter.title}</h3>
                            <p style="color: #888;">{new Date(latestPost.frontmatter.pubDate).toLocaleDateString()}</p>
                            <p>{latestPost.frontmatter.description}</p>
                        </div>
                    </a>
                )}
                <div class="post-row">
                    {otherPosts.map(post => (
                        <a href={post.url} class="post-card">
                            <img 
                                src={post.frontmatter.heroImage || '/assets/blog-placeholder-about.jpg'} 
                                alt={post.frontmatter.title} 
                                style="width: 100%; height: 140px; object-fit: cover; display: block; border-top-left-radius: 1rem; border-top-right-radius: 1rem;"
                                class="post-image"
                            />
                            <div style="padding: 1.5rem;">
                                <h3 style="margin-top: 0;font-family: 'SmileySans-Oblique';">{post.frontmatter.title}</h3>
                                <p style="color: #888;">{new Date(post.frontmatter.pubDate).toLocaleDateString()}</p>
                                <p>{post.frontmatter.description}</p>
                            </div>
                        </a>
                    ))}
                </div>
            </section>
		</main>
		<Footer />
	</body>
</html>

<style>
.post-card {
    background: #fff;
    border-radius: 1rem;
    box-shadow: 0 4px 16px rgba(0,0,0,0.10);
    padding: 0;
    text-decoration: none;
    color: inherit;
    overflow: hidden;
    transition: transform 0.2s cubic-bezier(.4,2,.6,1), box-shadow 0.2s;
    will-change: transform, box-shadow;
    display: block;
}
.post-card:hover {
    transform: translateY(-8px) scale(1.03);
    box-shadow: 0 8px 32px rgba(0,0,0,0.18);
    z-index: 1;
}
.post-card:hover .post-image {
    transform: scale(1.06) rotate(-1deg);
}
.post-card.featured {
    margin-bottom: 2rem;
}
.post-row {
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
    justify-content: center;
}
.post-row .post-card {
    flex: 1 1 300px;
    max-width: 48%;
}
@media (max-width: 800px) {
    .post-row {
        flex-direction: column;
    }
    .post-row .post-card {
        max-width: 100%;
    }
}
</style>
